(function(){function e(a,b){var c,e,i,j,k,l;if(!a)return;b||(b=[]);if(a.length!=null&&a[0]){l=[];for(m=0;m<a.length;m+=1)l.push(a[0]);a=l}else a=[a];d(b)||(b=[b]);for(var m=0;m<a.length;m+=1){c=a[m],k=c.nextSibling,j=c.parentNode,j!=null&&j.removeChild(c),f(c,b);for(var m=0;m<b.length;m+=1){i=b[m],e=c.fill.instances[m];for(var n=0;n<e.elements.length;n+=1)e.elements[n].fill.model=i;g(e,i),h(e,i)}k?j!=null&&j.insertBefore(c,k):j!=null&&j.appendChild(c)}return a}function f(a,b){var c,d,e;a.fill||(a.fill={});if(!a.fill.template){a.fill.template=[];while(a.firstChild)a.fill.template.push(a.removeChild(a.firstChild))}a.fill.templateCache||(a.fill.templateCache=[]),a.fill.instances||(a.fill.instances=[]);while(b.length>a.fill.instances.length){e=[];for(var f=0;f<a.fill.template.length;f+=1)c=a.fill.template[f].cloneNode(!0),e.push(c);d=a.fill.templateCache.pop()||{queryCache:{},template:e,elements:l(e)};for(var f=0;f<d.template.length;f+=1)a.appendChild(d.template[f]);a.fill.instances.push(d)}while(b.length<a.fill.instances.length){d=a.fill.instances.pop(),a.fill.templateCache.push(d);for(var f=0;f<d.template.length;f+=1)e=d.template[f],e.parentNode.removeChild(e)}for(var f=0;f<a.fill.instances.length;f+=1){d=a.fill.instances[f];for(var g=0;g<d.elements.length;g+=1){c=d.elements[g];for(var h in c.fill.attributes)c.setAttribute(h,c.fill.attributes[h])}}}function g(a,d){var e,f,g,h,i,j;if(typeof d=="object")for(g in d){h=d[g],h==null&&(h="");if(typeof h=="string"||typeof h=="number")h={_text:h};if(g[0]==="_")continue;j=k(a,g);for(var l=0;l<j.length;l+=1){i=j[l],c(i,h._text),b(i,h._html);for(e in h){if(e==="_text"||e==="_html")continue;if(e[0]!=="_")continue;f=h[e];if(typeof f!="string"&&typeof f!="number")continue;e=e.substr(1),i.fill.attributes=i.fill.attributes||{},i.fill.attributes[e]=i.getAttribute(e),i.setAttribute(e,f)}}}else i=k(a,"listElement")[0]||a.elements[0],i&&c(i,d)}function h(a,b){var c,d,f;for(c in b){d=b[c];if(typeof d!="object")continue;f=k(a,c);for(var g=0;g<f.length;g+=1)e(f[g],d)}}function j(b){return function(c,d){var e;if(!c||d==null)return;if(c.fill.content===d)return;c.fill.content=d;if(!c.fill.children){c.fill.children=[];for(i=0;i<c.childNodes.length;i+=1)e=c.childNodes[i],e.nodeType===a&&c.fill.children.push(e)}while(c.firstChild)c.removeChild(c.firstChild);b(c,d);for(i=0;i<c.fill.children.length;i+=1)c.appendChild(c.fill.children[i])}}function k(a,b){var c;if(!a.queryCache[b]){a.queryCache[b]=[];for(i=0;i<a.elements.length;i+=1)c=a.elements[i],m(c,b)&&a.queryCache[b].push(c)}return a.queryCache[b]}function l(b){var c,d,e,f=[];for(var g=0;g<b.length;g+=1){e=b[g];if(e.nodeType!==a)continue;e.fill||(e.fill={}),f.push(e),d=e.getElementsByTagName("*");for(var h=0;h<d.length;h+=1)c=d[h],c.fill||(c.fill={}),f.push(c)}return f}function m(a,b){var c=" "+a.className+" ";return a.id===b||c.indexOf(" "+b+" ")>-1||a.name===b||a.nodeName.toLowerCase()===b.toLowerCase()||a.getAttribute("data-bind")===b}var a=1,b,c,d=function(a){return Object.prototype.toString.call(a)==="[object Array]"};b=j(function(a,b){return a.innerHTML=b}),c=j(function(a,b){return a.nodeName.toLowerCase()==="input"?a.setAttribute("value",b):a.appendChild(a.ownerDocument.createTextNode(b))}),typeof jQuery!="undefined"&&jQuery!==null&&(jQuery.fn.fill=function(a){return e(this.get(),a),this}),typeof module!="undefined"&&module!==null&&(module.exports=e),this.fill=e}).call(this)